#Configure some settings for the netlify deployment

# netlify functions config
[functions]
# configure where netlify looks for functions instead of basedir/netlify/functions
directory = "backend/netlify/functions"

# Flags "express" as an external node module for all functions
external_node_modules = ["express"]

# Specifies `esbuild` for functions bundling
node_bundler = "esbuild"

# Includes all Markdown files inside the "files/" directory.
# included_files = ["files/*.md"]

# include all of the routes with the api
[functions."api"]
included_files = ["/backend/routes/**"]

[functions."api_*"]
# Flags "package-2" as an external node module for functions
# with a name beginning with "api_". Functions matching this
# pattern have both "package-1" and "package-2" as
# external modules, because modules from this object
# are concatenated with any from the top-level object.
# external_node_modules = ["package-2"]

# Includes all Markdown files previously defined in the
# top-level object, except for "post-1.md".
# included_files = ["!files/post-1.md"]

# [functions.api_payment]
# Flags "package-3" and "package-4" as external node modules
# for a function named "api_payment".
# This function has 4 external node modules:
#  "package-1" from the top-level object
#  "package-2" from the "api_*" object
#  "package-3" and "package-4" from this object
# external_node_modules = ["package-3", "package-4"]

# Includes all Markdown files inside "files/", except for
# "post-1.md" (excluded in the "api_*" object)
# and "post-2.md" (excluded in this object).
# Also includes "package.json" and any files
# inside "images/" or any of its subdirectories.
# included_files = ["!files/post-2.md", "package.json", "images/**"]

# redirect all calls to api to the netlify functions
[[redirects]]
force = true
from = "/api/*"
status = 200
to = "/.netlify/functions/api/:splat"

# /* /index.html 200
# redirect everything else thats not api to the react router
[[redirects]]
from = "/*"
to = "/index.html"
status = 200
